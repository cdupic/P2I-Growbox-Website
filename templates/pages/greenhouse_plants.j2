{% extends "greenhouse_template.j2" %}

{% block content %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/plants.css') }}">
    <script>
        window.available_plants = {{ available_plants|tojson }};
        window.current_plants = {{ current_plants|tojson }};
    </script>
    <script src="{{ url_for('static', filename="js/plants.js") }}"></script>

    <div class="heading">
        <div class="title">
            <h1>Gestion des plantes</h1>
            <p>{{ greenhouse_name }} contient {{ nb_distinct_plants }} plantes distinctes
                ({{ nb_crops }} graines en tout)</p>
        </div>
    </div>

    <div>

        <style>
            #plantForm {
                margin: 5px;
            }
            #plantForm .association {
                background-color: white;
                border-radius: 10px;
                margin: 5px 0;
                padding: 10px;
            }
            #plantForm .association .controls {
                display: flex;
            }
            #plantForm .association .config p{
                font-size: .8em;
            }
        </style>


        <form id="plantForm" method="POST" action="{{ url_for('plant_manager') }}">

            <h2>Plantes actuellement dans la serre</h2>

            {% for association_id, (plant_id, plant_name, count, start_date) in current_plants.items() %}
                <div id="currentPlants">

                </div>
            {% endfor %}

            <input type="submit" value="Enregistrer les modifications">

            <h2>Ajouter une plante</h2>

            <div class="add-plant-inputs">
                <label for="input-plant-search" style="display: none">Rechercher une plante</label>
                <input type="text" name="input-plant-search" id="input-plant-search">
                <label for="input-plant-count" style="display: none">Rechercher une plante</label>
                <input type="number" min="0" name="input-plant-count" id="input-plant-count">
            </div>
            <ul id="plant-results">

            </ul>
        </form>

        <p> Plantes présentes auparavant </p>
        <ul>
            {% for couple in plants_history_greenhouse %}
                {%  for plante, dates in couple.items() %}
                    <p>  {{ plante }} du : {{ dates[0]}} au {{ dates[1] }} </p>
                {%  endfor %}
            {% endfor %}
        </ul>
    </div>

    <div>
        <h2>Configurer les asservissements manuellement</h2>
        <p> Plantes actuellement présentes</p>
    </div>


{% endblock %}
