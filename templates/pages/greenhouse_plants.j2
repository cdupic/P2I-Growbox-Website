{% extends "greenhouse_template.j2" %}

{% block content %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/plants.css') }}">
    <script>
        window.available_plants = {{ available_plants|tojson }};
        window.current_plants = {{ current_plants|tojson }};
    </script>
    <script src="{{ url_for('static', filename="js/plants.js") }}"></script>

    <div class="heading">
        <div class="title">
            <h1>Gestion des plantes</h1>
            <p>{{ greenhouse_name }} contient {{ nb_distinct_plants }} plantes distinctes
                ({{ nb_crops }} graines en tout)</p>
        </div>
    </div>

    <div>
        <form id="plantForm" method="POST" action="{{ url_for('plant_manager') }}">

            <input type="hidden" name="greenhouse_id" value="{{ greenhouse_id }}">
            <input type="hidden" name="action" value="update">

            <input type="hidden" id="removeAssociationsInput" name="remove-associations" value="">
            <input type="hidden" id="addPlantsInput" name="add-plant" value="">
            <input type="hidden" id="addPlantsCountInput" name="add-plant-count" value="">

            <h2>Plantes actuellement dans la serre</h2>

            <ul id="currentPlants">

            </ul>

            <input type="submit" value="Enregistrer les modifications">

            <h2>Ajouter une plante</h2>

            <div class="add-plant-inputs">
                <div>
                    <label for="input-plant-search">Rechercher une plante</label>
                    <input type="text" name="input-plant-search" id="newPlantSearch">
                </div>
                <div>
                    <label for="input-plant-count">Nombre</label>
                    <input type="number" min="0" name="input-plant-count" id="newPlantCount" value="1">
                </div>
            </div>
            <ul id="plant-results">

            </ul>
        </form>

        <p> Plantes présentes auparavant </p>
        <ul>
            {% for couple in plants_history_greenhouse %}
                {%  for plante, dates in couple.items() %}
                    <p>  {{ plante }} du : {{ dates[0]}} au {{ dates[1] }} </p>
                {%  endfor %}
            {% endfor %}
        </ul>
    </div>

    <div>
        <h2>Configurer les asservissements manuellement</h2>
        <p> Plantes actuellement présentes</p>
    </div>


{% endblock %}
